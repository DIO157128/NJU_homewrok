## 问题一

### 第一小问

#### 数据处理

首先，由于纹饰、颜色、玻璃类型、是否风化属于文本数据，因此需要进行量化处理。对于每个字段来说，我们将所有可能出现的取值进行映射，对于每个字段中的每个取值，给予一个针对字段的唯一数字，建立一张针对每个字段的映射表。然后使用该映射表，对于原数据进行量化处理。

我们需要寻找是否风化与纹饰，类型，颜色之间的关系。由于数据有三个维度，因此我们采用卡方检验和皮尔逊相关性检验来寻找这三对关联性。

#### 卡方检验



#### 皮尔逊相关性

![image-20220918002231103](C:\Users\dell\Desktop\9.15model\问题一\imgs\image-20220918002231103.png)

![image-20220918002254672](C:\Users\dell\Desktop\9.15model\问题一\imgs\image-20220918002254672.png)

![image-20220918002307976](C:\Users\dell\Desktop\9.15model\问题一\imgs\image-20220918002307976.png)

#### 结论

玻璃是否风化与玻璃类型（高钾，铅钡）有关，与颜色和纹饰无关

### 第二小问

我们首先按照是否风化和玻璃类型两个指标对源数据进行切割。综合表单一和表单二，得到了每个文物不同部位的各项化学成分含量和类型、是否风化的数据表格。第二小问中，我们在这张表格上进行研究。

第一步，先统计各个化学成分的均值，绘制堆积条形图来描述不同类型的文物的化学组成。

第二步，使用灰色关联度分析，寻找玻璃类型与各项成分之间的关系，是否风化与各项成分之间的关系。

第三步，使用PCA，分析各个化学成分在决定玻璃类型、是否风化时的重要程度

#### 结论

##### 均值分析

![image-20220917134010492](C:\Users\dell\Desktop\9.15model\问题一\imgs\均值统计.png)

##### 灰色关联度分析

###### 决定玻璃类型的化学成分

| 关联度结果       |        |      |
| ---------------- | ------ | ---- |
| 评价项           | 关联度 | 排名 |
| 氧化铅(PbO)      | 0.964  | 1    |
| 二氧化硅(SiO2)   | 0.962  | 2    |
| 氧化钡(BaO)      | 0.958  | 3    |
| 氧化铝(Al2O3)    | 0.958  | 4    |
| 氧化锶(SrO)      | 0.957  | 5    |
| 氧化钙(CaO)      | 0.949  | 6    |
| 氧化镁(MgO)      | 0.947  | 7    |
| 氧化铜(CuO)      | 0.942  | 8    |
| 五氧化二磷(P2O5) | 0.938  | 9    |
| 氧化铁(Fe2O3)    | 0.933  | 10   |
| 二氧化硫(SO2)    | 0.915  | 11   |
| 氧化钠(Na2O)     | 0.914  | 12   |
| 氧化锡(SnO2)     | 0.911  | 13   |
| 氧化钾(K2O)      | 0.906  | 14   |

###### 决定是否风化的化学成分

| 关联度结果       |        |      |
| ---------------- | ------ | ---- |
| 评价项           | 关联度 | 排名 |
| 氧化铅(PbO)      | 0.963  | 1    |
| 二氧化硅(SiO2)   | 0.957  | 2    |
| 氧化锶(SrO)      | 0.952  | 3    |
| 氧化铝(Al2O3)    | 0.952  | 4    |
| 氧化钙(CaO)      | 0.95   | 5    |
| 氧化钡(BaO)      | 0.95   | 6    |
| 氧化铜(CuO)      | 0.944  | 7    |
| 氧化镁(MgO)      | 0.942  | 8    |
| 五氧化二磷(P2O5) | 0.941  | 9    |
| 氧化铁(Fe2O3)    | 0.93   | 10   |
| 二氧化硫(SO2)    | 0.916  | 11   |
| 氧化锡(SnO2)     | 0.91   | 12   |
| 氧化钠(Na2O)     | 0.908  | 13   |
| 氧化钾(K2O)      | 0.908  | 14   |

##### PCA分析

###### 风化

| KMO检验和Bartlett的检验                       |          |         |
| --------------------------------------------- | -------- | ------- |
| KMO值                                         | 0.442    |         |
| Bartlett球形度检验                            | 近似卡方 | 340.277 |
| df                                            | 91.000   |         |
| p                                             | 0.000*** |         |
| 注：***、**、*分别代表1%、5%、10%的显著性水平 |          |         |


**图表说明：**

上表展示了KMO检验和Bartlett球形检验的结果，用来分析是否可以进行主成分分析。
 ● 若通过KMO检验（KMO>0.6），说明了题项变量之间是存在相关性的，符合主成分分析要求;
 ● 若通过Bartlett检验：P<0.01或P<0.05, 呈显著性，则可以进行主成分分析。

KMO检验的结果显示，KMO的值为0.442，同时，Bartlett球形检验的结果显示，显著性P值为0.000***，水平上呈现显著性，拒绝原假设，各变量间具有相关性，主成分分析有效，程度为极不适合。

未风化、铅钡、高钾同理，无法使用PCA

#### 结论

  二氧化硅(SiO2)  、氧化锶(SrO)  、  氧化铝(Al2O3)  、  氧化钙(CaO)  、  氧化钡(BaO)  对是否风化有很大影响

### 第三小问

为了预测文物未风化前的各项化学含量，我们使用了岭回归进行预测。首先分别按照铅钡和高钾玻璃分别进行岭回归，得到未风化前化学含量的计算公式。

#### 岭回归

下面展示Na2O的岭回归过程

岭迹图：

![image-20220918150539730](C:\Users\dell\Desktop\9.15model\问题一\imgs\岭迹图.png)



| K=0.122                                       | 非标准化系数 | 标准化系数 | 𝑡      | 𝑝      | 𝑅²       | 调整𝑅² | 𝐹     |                  |
| --------------------------------------------- | ------------ | ---------- | ------ | ------ | -------- | ------ | ----- | ---------------- |
| B                                             | 标准误       | Beta       |        |        |          |        |       |                  |
| 常数                                          | 91.055       | 1.965      | -      | 46.347 | 0.000*** | 0.998  | 0.987 | 90.975(0.002***) |
| 氧化钙(CaO)                                   | -0.898       | 0.115      | -0.205 | -7.796 | 0.004*** |        |       |                  |
| 五氧化二磷(P2O5)                              | -0.476       | 0.301      | -0.042 | -1.584 | 0.211    |        |       |                  |
| 氧化锶(SrO)                                   | -26.878      | 9.819      | -0.081 | -2.737 | 0.071*   |        |       |                  |
| 氧化钾(K2O)                                   | -0.651       | 0.074      | -0.239 | -8.855 | 0.003*** |        |       |                  |
| 氧化铁(Fe2O3)                                 | -1.074       | 0.278      | -0.116 | -3.865 | 0.031**  |        |       |                  |
| 氧化钠(Na2O)                                  | -2.102       | 0.341      | -0.158 | -6.166 | 0.009*** |        |       |                  |
| 氧化铝(Al2O3)                                 | -0.624       | 0.113      | -0.133 | -5.529 | 0.012**  |        |       |                  |
| 氧化铜(CuO)                                   | -1.103       | 0.275      | -0.114 | -4.013 | 0.028**  |        |       |                  |
| 氧化锡(SnO2)                                  | -0.546       | 0.679      | -0.021 | -0.804 | 0.480    |        |       |                  |
| 氧化镁(MgO)                                   | -2.189       | 0.552      | -0.108 | -3.966 | 0.029**  |        |       |                  |
| 氧化铅(PbO)                                   | -0.756       | 0.851      | -0.027 | -0.888 | 0.440    |        |       |                  |
| 氧化钡(BaO)                                   | -0.409       | 0.427      | -0.024 | -0.958 | 0.409    |        |       |                  |
| 二氧化硫(SO2)                                 | -6.154       | 2.277      | -0.067 | -2.703 | 0.074*   |        |       |                  |
| 是否风化                                      | 3.756        | 0.941      | 0.126  | 3.991  | 0.028**  |        |       |                  |
| 因变量：二氧化硅(SiO2)                        |              |            |        |        |          |        |       |                  |
| 注：***、**、*分别代表1%、5%、10%的显著性水平 |              |            |        |        |          |        |       |                  |

**图表说明：**

上表格展示了本次模型的参数结果及检验结果，包括模型的标准化系数、𝑡值、𝐹检验的结果、𝑅²、调整𝑅²等，用于模型的检验，并分析模型的公式。
 ● 曲线回归模型要求总体的回归系数不为0，即变量之间存在回归关系。根据𝐹检验的𝑝值对模型进行检验。

**
** **智能分析：**

岭回归的结果显示：基于字段氧化钙(CaO)、五氧化二磷(P2O5)、氧化锶(SrO)、氧化钾(K2O)、氧化铁(Fe2O3)、氧化钠(Na2O)、氧化铝(Al2O3)、氧化铜(CuO)、氧化锡(SnO2)、氧化镁(MgO)、氧化铅(PbO)、氧化钡(BaO)、二氧化硫(SO2)、是否风化回归模型显著性𝑝值为0.002***，水平上呈现显著性，拒绝原假设，表明自变量与因变量之间存在着回归关系。同时，模型的拟合优度𝑅²为0.998，模型表现为较为较为优秀，因此模型基本满足要求。
 模型的公式：二氧化硅(SiO2)=91.055-0.898 × 氧化钙(CaO)-0.476 × 五氧化二磷(P2O5)-26.878 × 氧化锶(SrO)-0.651 × 氧化钾(K2O)-1.074 × 氧化铁(Fe2O3)-2.102 × 氧化钠(Na2O)-0.624 × 氧化铝(Al2O3)-1.103 × 氧化铜(CuO)-0.546 × 氧化锡(SnO2)-2.189 × 氧化镁(MgO)-0.756 × 氧化铅(PbO)-0.409 × 氧化钡(BaO)-6.154 × 二氧化硫(SO2)＋3.756 × 是否风化

![image-20220918150740457](C:\Users\dell\Desktop\9.15model\问题一\imgs\模型轨迹图.png)

使用岭回归得到各项化学成分含量的预测公式后，将待预测数值代入公式计算即可得到未风化前化学成分含量

#### 预测结果

以下为岭回归计算后的预测结果（见支撑材料）

为了使结果更加合理，我们需要对预测结果进行修正。

部分预测数据为负值，显然这与实际情况不符，所以对于值为负数的预测结果，我们统一将它们规约为0

对于铅钡玻璃来说，严重风华点属于异常数据，无法使用普适的预测公式来进行预测。严重风化点的二氧化硅和氧化铜含量与普通风化文物的含量极为不同，因此我们对该结果进行修正。

最终结果见支撑材料



